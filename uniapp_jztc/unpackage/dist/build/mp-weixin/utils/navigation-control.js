"use strict";const e=require("../common/vendor.js"),n=require("./message-polling.js"),i=["/pages/index/index","/pages/community/index","/pages/publish/index","/pages/message/index","/pages/my/index"];function l(e){const n=e.split("?")[0];return i.includes(n)}function o(e){const i=e.split("?")[0];n.messagePollingService.setCurrentPage(i),l(i)||(n.messagePollingService.pausePollingGlobally(),console.log("导航到非底部导航页面，暂停轮询:",i))}const s={isTabBarPage:l,beforeNavigateTo:o,beforeNavigateBack:function(e,i){n.messagePollingService.setCurrentPage(i),!l(e)&&l(i)&&(n.messagePollingService.resumePollingGlobally(),console.log("返回到底部导航页面，恢复轮询:",i))},initNavigationInterceptors:function(){const i=e.index.navigateTo,s=e.index.redirectTo,t=e.index.reLaunch,a=e.index.switchTab,r=e.index.navigateBack;e.index.navigateTo=function(e){return o(e.url),i.call(this,e)},e.index.redirectTo=function(e){return o(e.url),s.call(this,e)},e.index.reLaunch=function(e){const i=e.url;return n.messagePollingService.pausePollingGlobally(),l(i.split("?")[0])&&setTimeout((()=>{n.messagePollingService.resumePollingGlobally()}),100),t.call(this,e)},e.index.switchTab=function(e){return e.url,setTimeout((()=>{n.messagePollingService.resumePollingGlobally()}),100),a.call(this,e)},e.index.navigateBack=function(e){return r.call(this,e)},console.log("导航拦截器初始化完成")}};exports.navigationControl=s;
