"use strict";const t=require("../../common/vendor.js"),e=require("../../utils/request.js"),r=require("../../utils/pinyin.js"),n={namespaced:!0,state:{regionList:[],loading:!1,error:null},getters:{groupedRegionList:t=>{const e={};return t.regionList.length?(t.regionList.forEach((t=>{const n=r.getStringFirstLetter(t.name);e[n]||(e[n]=[]),e[n].push(t)})),e):e},hotRegions:t=>{const e=t.regionList.filter((t=>1===t.hot));return e.length>0?e:t.regionList.slice(0,9)}},mutations:{SET_REGION_LIST(t,e){t.regionList=e},SET_LOADING(t,e){t.loading=e},SET_ERROR(t,e){t.error=e}},actions:{async getRegionList({commit:r},n={status:0}){r("SET_LOADING",!0),r("SET_ERROR",null);try{const o=await e.get("/wx/client/region/list",n,!0);if(o&&0===o.code){const e=o.data.list.map((t=>({id:t.id,name:t.name,location:t.location,level:t.level,hot:t.hot||0,status:t.status,createdAt:t.createdAt,updatedAt:t.updatedAt})));r("SET_REGION_LIST",e);try{t.index.setStorageSync("regionList",JSON.stringify(e)),console.log("区域列表数据已保存到本地存储，共",e.length,"条记录")}catch(i){console.error("保存区域列表到本地存储失败:",i)}return e}return r("SET_ERROR",(null==o?void 0:o.message)||"获取地区列表失败"),[]}catch(o){return console.error("获取地区列表出错:",o),r("SET_ERROR",o.message||"获取地区列表失败"),[]}finally{r("SET_LOADING",!1)}}}};exports.region=n;
