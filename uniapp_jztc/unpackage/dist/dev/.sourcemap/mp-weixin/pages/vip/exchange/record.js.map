{"version":3,"file":"record.js","sources":["pages/vip/exchange/record.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdmlwL2V4Y2hhbmdlL3JlY29yZC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 状态栏占位 -->\r\n\t\t<view class=\"status-bar\" :style=\"{ height: statusBarHeight + 'px' }\"></view>\r\n\t\t\r\n\t\t<!-- 自定义导航栏 -->\r\n\t\t<view class=\"nav-bar\">\r\n\t\t\t<view class=\"nav-content\">\r\n\t\t\t\t<view class=\"back-btn\" @tap=\"handleBack\">\r\n\t\t\t\t\t<uni-icons type=\"left\" size=\"20\" color=\"#333333\"></uni-icons>\r\n\t\t\t\t</view>\r\n\t\t\t\t<text class=\"nav-title\">兑换记录</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 记录列表 -->\r\n\t\t<view class=\"record-list\">\r\n\t\t\t<view class=\"record-item\" v-for=\"item in recordList\" :key=\"item.id\">\r\n\t\t\t\t<view class=\"record-top\">\r\n\t\t\t\t\t<view class=\"record-date\">{{item.exchangeTime}}</view>\r\n\t\t\t\t\t<view class=\"record-status\" :class=\"getStatusClass(item.status)\">{{formatStatus(item.status)}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"record-content\">\r\n\t\t\t\t\t<view class=\"product-info\">\r\n\t\t\t\t\t\t<text class=\"product-name\">{{item.productName}}</text>\r\n\t\t\t\t\t\t<text class=\"duration\">支出时长：{{item.duration}}天</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"record-account\">\r\n\t\t\t\t\t\t<text class=\"account-label\">兑换账号：</text>\r\n\t\t\t\t\t\t<text class=\"account-value\">{{item.rechargeAccount}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"record-remark\" v-if=\"item.remark\">\r\n\t\t\t\t\t\t<text class=\"remark-label\">备注：</text>\r\n\t\t\t\t\t\t<text class=\"remark-content\">{{item.remark}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载更多 -->\r\n\t\t\t<uni-load-more :status=\"loadMoreStatus\" v-if=\"recordList.length > 0\"></uni-load-more>\r\n\t\t\t\r\n\t\t\t<!-- 空状态 -->\r\n\t\t\t<view class=\"empty-state\" v-if=\"recordList.length === 0 && !isLoading\">\r\n\t\t\t\t<image class=\"empty-image\" src=\"/static/images/empty-record.png\" mode=\"aspectFit\"></image>\r\n\t\t\t\t<text class=\"empty-text\">暂无兑换记录</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport deviceMixin from '@/mixins/device.js'\r\n\timport { vip } from '@/apis/index.js'\r\n\timport uniIcons from '@dcloudio/uni-ui/lib/uni-icons/uni-icons'\r\n\timport uniLoadMore from '@dcloudio/uni-ui/lib/uni-load-more/uni-load-more'\r\n\t\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tuniIcons,\r\n\t\t\tuniLoadMore\r\n\t\t},\r\n\t\tmixins: [deviceMixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\trecordList: [],\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tsize: 10,\r\n\t\t\t\ttotalPages: 0,\r\n\t\t\t\tisLoading: false,\r\n\t\t\t\tloadMoreStatus: 'more' // more-加载前 loading-加载中 noMore-没有更多\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.getExchangeRecords()\r\n\t\t},\r\n\t\t// 下拉刷新\r\n\t\tonPullDownRefresh() {\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.recordList = []\r\n\t\t\tthis.getExchangeRecords().then(() => {\r\n\t\t\t\tuni.stopPullDownRefresh()\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 上拉加载更多\r\n\t\tonReachBottom() {\r\n\t\t\tif (this.page < this.totalPages && this.loadMoreStatus !== 'loading') {\r\n\t\t\t\tthis.page++\r\n\t\t\t\tthis.loadMoreStatus = 'loading'\r\n\t\t\t\tthis.getExchangeRecords()\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\thandleBack() {\r\n\t\t\t\tuni.navigateBack()\r\n\t\t\t},\r\n\t\t\t// 格式化状态为中文\r\n\t\t\tformatStatus(status) {\r\n\t\t\t\t// 处理英文状态转中文\r\n\t\t\t\tif (!status) return '未知状态'\r\n\t\t\t\t\r\n\t\t\t\t// 转为小写进行比较\r\n\t\t\t\tconst statusLower = typeof status === 'string' ? status.toLowerCase() : status\r\n\t\t\t\t\r\n\t\t\t\tif (statusLower === 'processing' || statusLower === '处理中') {\r\n\t\t\t\t\treturn '处理中'\r\n\t\t\t\t} else if (statusLower === 'completed' || statusLower === '已完成') {\r\n\t\t\t\t\treturn '已完成'\r\n\t\t\t\t} else if (statusLower === 'failed' || statusLower === '失败') {\r\n\t\t\t\t\treturn '失败'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn status // 返回原始状态\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 获取状态样式类\r\n\t\t\tgetStatusClass(status) {\r\n\t\t\t\t// 转为小写进行比较\r\n\t\t\t\tconst statusLower = typeof status === 'string' ? status.toLowerCase() : status\r\n\t\t\t\t\r\n\t\t\t\tif (statusLower === 'processing' || statusLower === '处理中') {\r\n\t\t\t\t\treturn 'status-processing'\r\n\t\t\t\t} else if (statusLower === 'completed' || statusLower === '已完成') {\r\n\t\t\t\t\treturn 'status-success'\r\n\t\t\t\t} else if (statusLower === 'failed' || statusLower === '失败') {\r\n\t\t\t\t\treturn 'status-failed'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 'status-processing' // 默认处理中样式\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 获取兑换记录\r\n\t\t\tasync getExchangeRecords() {\r\n\t\t\t\tif (this.isLoading) return\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.isLoading = true\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst params = {\r\n\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\tsize: this.size\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst res = await vip.getExchangeRecords(params)\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (res.code === 0 && res.data) {\r\n\t\t\t\t\t\tif (this.page === 1) {\r\n\t\t\t\t\t\t\tthis.recordList = res.data.list || []\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.recordList = [...this.recordList, ...(res.data.list || [])]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.totalPages = res.data.pages || 0\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 更新加载状态\r\n\t\t\t\t\t\tif (this.page >= this.totalPages) {\r\n\t\t\t\t\t\t\tthis.loadMoreStatus = 'noMore'\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.loadMoreStatus = 'more'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.message || '获取兑换记录失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('获取兑换记录失败:', error)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '获取记录失败，请重试',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tthis.isLoading = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: #f5f5f5;\r\n\t}\r\n\t\r\n\t.status-bar {\r\n\t\tbackground: #ffffff;\r\n\t}\r\n\t\r\n\t.nav-bar {\r\n\t\tbackground: #ffffff;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\t\r\n\t.nav-content {\r\n\t\theight: 44px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 30rpx;\r\n\t\tposition: relative;\r\n\t}\r\n\t\r\n\t.back-btn {\r\n\t\tposition: absolute;\r\n\t\tleft: 30rpx;\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.nav-title {\r\n\t\tcolor: #333333;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tposition: absolute;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%);\r\n\t}\r\n\t\r\n\t.record-list {\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\t\r\n\t.record-item {\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 12rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\t\r\n\t.record-top {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding-bottom: 16rpx;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.record-date {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666666;\r\n\t}\r\n\t\r\n\t.record-status {\r\n\t\tfont-size: 24rpx;\r\n\t\tpadding: 2rpx 12rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t}\r\n\t\r\n\t.status-success {\r\n\t\tcolor: #27ae60;\r\n\t\tbackground-color: rgba(39, 174, 96, 0.1);\r\n\t}\r\n\t\r\n\t.status-processing {\r\n\t\tcolor: #f39c12;\r\n\t\tbackground-color: rgba(243, 156, 18, 0.1);\r\n\t}\r\n\t\r\n\t.status-failed {\r\n\t\tcolor: #e74c3c;\r\n\t\tbackground-color: rgba(231, 76, 60, 0.1);\r\n\t}\r\n\t\r\n\t.record-content {\r\n\t\tpadding-top: 16rpx;\r\n\t}\r\n\t\r\n\t.product-info {\r\n\t\tmargin-bottom: 12rpx;\r\n\t}\r\n\t\r\n\t.product-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333333;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\t\r\n\t.duration {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666666;\r\n\t}\r\n\t\r\n\t.record-account {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #333333;\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\t\r\n\t.account-label {\r\n\t\tcolor: #666666;\r\n\t}\r\n\t\r\n\t.record-remark {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #333333;\r\n\t}\r\n\t\r\n\t.remark-label {\r\n\t\tcolor: #666666;\r\n\t}\r\n\t\r\n\t.empty-state {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 100rpx 0;\r\n\t}\r\n\t\r\n\t.empty-image {\r\n\t\twidth: 200rpx;\r\n\t\theight: 200rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999999;\r\n\t}\r\n</style> ","import MiniProgramPage from 'E:/Myxiangmu/chonggou/juzitongcheng/pages/vip/exchange/record.vue'\nwx.createPage(MiniProgramPage)"],"names":["deviceMixin","uni","vip"],"mappings":"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"}