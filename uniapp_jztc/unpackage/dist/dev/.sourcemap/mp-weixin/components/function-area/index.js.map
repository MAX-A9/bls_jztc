{"version":3,"file":"index.js","sources":["components/function-area/index.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovTXl4aWFuZ211L2Nob25nZ291L2p1eml0b25nY2hlbmcvY29tcG9uZW50cy9mdW5jdGlvbi1hcmVhL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"grid-container\" v-if=\"isGlobalEnabled\">\r\n\t\t<scroll-view \r\n\t\t\tclass=\"scroll-row scroll-view-container\" \r\n\t\t\tscroll-x=\"true\" \r\n\t\t\t:enhanced=\"true\"\r\n\t\t\t@scroll=\"handleScroll\"\r\n\t\t>\r\n\t\t\t<!-- 小程序列表 -->\r\n\t\t\t<view \r\n\t\t\t\tclass=\"grid-item\" \r\n\t\t\t\tv-for=\"(item) in miniProgramList\" \r\n\t\t\t\t:key=\"'mini-' + item.id\"\r\n\t\t\t\t@click=\"navigateToMiniProgram(item)\"\r\n\t\t\t>\r\n\t\t\t\t<image :src=\"item.logo\" mode=\"aspectFill\" class=\"logo-image\"></image>\r\n\t\t\t\t<text class=\"item-text\">{{ item.name }}</text>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 滚动指示器 -->\r\n\t\t<view class=\"scroll-indicator\" v-if=\"miniProgramList.length > 0\">\r\n\t\t\t<view \r\n\t\t\t\tclass=\"indicator-bar\"\r\n\t\t\t\t:style=\"{ transform: `translateX(${currentPage * 100}%)` }\"\r\n\t\t\t></view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport { getMiniProgramList } from '@/apis/content.js'\r\n\t\r\n\texport default {\r\n\t\tname: 'FunctionArea',\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tscrollLeft: 0,\r\n\t\t\t\tcontentWidth: 0, // 内容总宽度\r\n\t\t\t\tviewWidth: 0, // 可视区域宽度\r\n\t\t\t\tcurrentPage: 0, // 当前页码\r\n\t\t\t\tisGlobalEnabled: true, // 默认显示，加载完成后根据接口返回值更新\r\n\t\t\t\tminiProgramList: [] // 小程序列表\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// 移除自动加载，由父组件控制加载时机\r\n\t\t\t// this.loadMiniProgramList()\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.initScrollBar()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 加载小程序列表\r\n\t\t\tasync loadMiniProgramList() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst res = await getMiniProgramList()\r\n\t\t\t\t\tif (res.code === 0 && res.data) {\r\n\t\t\t\t\t\t// 更新全局启用状态\r\n\t\t\t\t\t\tthis.isGlobalEnabled = res.data.isGlobalEnabled\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 如果启用，则更新小程序列表\r\n\t\t\t\t\t\tif (this.isGlobalEnabled && res.data.list) {\r\n\t\t\t\t\t\t\t// 按order字段排序\r\n\t\t\t\t\t\t\tthis.miniProgramList = res.data.list\r\n\t\t\t\t\t\t\t\t.filter(item => item.isEnabled) // 只展示启用的小程序\r\n\t\t\t\t\t\t\t\t.sort((a, b) => a.order - b.order)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error('获取小程序列表失败:', res.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('加载小程序列表异常:', error)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 跳转到小程序\r\n\t\t\tnavigateToMiniProgram(miniProgram) {\r\n\t\t\t\tuni.navigateToMiniProgram({\r\n\t\t\t\t\tappId: miniProgram.appId,\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tconsole.log('跳转成功', res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\tconsole.error('跳转失败', err)\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '跳转失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinitScrollBar() {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this)\r\n\t\t\t\tquery.select('.scroll-row').boundingClientRect(data => {\r\n\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\tthis.viewWidth = data.width\r\n\t\t\t\t\t}\r\n\t\t\t\t}).exec()\r\n\t\t\t},\r\n\t\t\thandleScroll(e) {\r\n\t\t\t\tconst { scrollLeft, scrollWidth } = e.detail\r\n\t\t\t\t// 计算滚动比例\r\n\t\t\t\tconst maxScroll = scrollWidth - this.viewWidth\r\n\t\t\t\t// 计算当前页码（0到1之间的小数）\r\n\t\t\t\tthis.currentPage = maxScroll > 0 ? scrollLeft / maxScroll : 0\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.grid-container {\r\n\t\tpadding: 30rpx 0;\r\n\t\tbackground-color: #ffffff;\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.scroll-row {\r\n\t\twidth: 100%;\r\n\t\twhite-space: nowrap;\r\n\t\tpadding: 0 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\t\r\n\t.grid-item {\r\n\t\tdisplay: inline-flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 20%;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 0 10rpx;\r\n\t\tvertical-align: top;\r\n\t}\r\n\t\r\n\t.grid-item:nth-child(n+6) {\r\n\t\twidth: auto;\r\n\t\tpadding: 0 20rpx;\r\n\t}\r\n\t\r\n\t.logo-image {\r\n\t\twidth: 110rpx;\r\n\t\theight: 110rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tmargin-bottom: 12rpx;\r\n\t}\r\n\t\r\n\t.item-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #333333;\r\n\t\tline-height: 1.4;\r\n\t\twhite-space: nowrap;\r\n\t\ttext-align: center;\r\n\t\theight: 34rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t\r\n\t/* 滚动指示器样式 */\r\n\t.scroll-indicator {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 16rpx;\r\n\t\tposition: relative;\r\n\t\twidth: 80rpx;\r\n\t\theight: 8rpx;\r\n\t\tbackground-color: #dddddd;\r\n\t\tborder-radius: 4rpx;\r\n\t\tmargin-left: auto;\r\n\t\tmargin-right: auto;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.indicator-bar {\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\twidth: 50%;\r\n\t\theight: 100%;\r\n\t\tborder-radius: 4rpx;\r\n\t\tbackground-color: #fc3e2b;\r\n\t\ttransition: transform 0.3s;\r\n\t}\r\n</style> ","import Component from 'E:/Myxiangmu/chonggou/juzitongcheng/components/function-area/index.vue'\nwx.createComponent(Component)"],"names":["getMiniProgramList","uni"],"mappings":";;;AAiCC,MAAK,YAAU;AAAA,EACd,MAAM;AAAA,EACN,OAAO;AACN,WAAO;AAAA,MACN,YAAY;AAAA,MACZ,cAAc;AAAA;AAAA,MACd,WAAW;AAAA;AAAA,MACX,aAAa;AAAA;AAAA,MACb,iBAAiB;AAAA;AAAA,MACjB,iBAAiB,CAAC;AAAA;AAAA,IACnB;AAAA,EACA;AAAA,EACD,UAAU;AAAA,EAGT;AAAA,EACD,UAAU;AACT,SAAK,cAAc;AAAA,EACnB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,MAAM,sBAAsB;AAC3B,UAAI;AACH,cAAM,MAAM,MAAMA,gCAAmB;AACrC,YAAI,IAAI,SAAS,KAAK,IAAI,MAAM;AAE/B,eAAK,kBAAkB,IAAI,KAAK;AAGhC,cAAI,KAAK,mBAAmB,IAAI,KAAK,MAAM;AAE1C,iBAAK,kBAAkB,IAAI,KAAK,KAC9B,OAAO,UAAQ,KAAK,SAAS,EAC7B,KAAK,CAAC,GAAG,MAAM,EAAE,QAAQ,EAAE,KAAK;AAAA,UACnC;AAAA,eACM;AACNC,wBAAc,MAAA,MAAA,SAAA,4CAAA,cAAc,IAAI,OAAO;AAAA,QACxC;AAAA,MACC,SAAO,OAAO;AACfA,sBAAAA,MAAA,MAAA,SAAA,4CAAc,cAAc,KAAK;AAAA,MAClC;AAAA,IACA;AAAA;AAAA,IAED,sBAAsB,aAAa;AAClCA,oBAAAA,MAAI,sBAAsB;AAAA,QACzB,OAAO,YAAY;AAAA,QACnB,QAAQ,KAAK;AACZA,wBAAAA,MAAA,MAAA,OAAA,4CAAY,QAAQ,GAAG;AAAA,QACvB;AAAA,QACD,KAAK,KAAK;AACTA,wBAAAA,MAAA,MAAA,SAAA,4CAAc,QAAQ,GAAG;AACzBA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,WACN;AAAA,QACF;AAAA,OACA;AAAA,IACD;AAAA,IACD,gBAAgB;AACf,YAAM,QAAQA,cAAG,MAAC,oBAAmB,EAAG,GAAG,IAAI;AAC/C,YAAM,OAAO,aAAa,EAAE,mBAAmB,UAAQ;AACtD,YAAI,MAAM;AACT,eAAK,YAAY,KAAK;AAAA,QACvB;AAAA,MACA,CAAA,EAAE,KAAK;AAAA,IACR;AAAA,IACD,aAAa,GAAG;AACf,YAAM,EAAE,YAAY,YAAc,IAAE,EAAE;AAEtC,YAAM,YAAY,cAAc,KAAK;AAErC,WAAK,cAAc,YAAY,IAAI,aAAa,YAAY;AAAA,IAC7D;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;AC1GD,GAAG,gBAAgB,SAAS;"}