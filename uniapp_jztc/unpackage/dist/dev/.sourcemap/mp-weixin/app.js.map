{"version":3,"file":"app.js","sources":["components/login-modal/index.vue","App.vue","main.js"],"sourcesContent":["<template>\r\n\t<view v-if=\"visible\" class=\"login-modal\">\r\n\t\t<view class=\"modal-mask\" @tap=\"cancel\"></view>\r\n\t\t<view class=\"modal-content\">\r\n\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t<text class=\"modal-title\">登录</text>\r\n\t\t\t\t<view class=\"close-btn\" @tap=\"cancel\">\r\n\t\t\t\t\t<uni-icons type=\"close\" size=\"20\" color=\"#999999\"></uni-icons>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"modal-body\">\r\n\t\t\t\t<view class=\"login-icon\">\r\n\t\t\t\t\t<image src=\"/static/images/login-icon.png\" mode=\"aspectFit\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<text class=\"login-tips\">请登录后继续操作</text>\r\n\t\t\t\t\r\n\t\t\t\t<button \r\n\t\t\t\t\tclass=\"wx-login-btn\" \r\n\t\t\t\t\topen-type=\"getUserInfo\" \r\n\t\t\t\t\t@tap=\"handleLogin\" \r\n\t\t\t\t\t:loading=\"loading\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<uni-icons v-if=\"!loading\" type=\"weixin\" size=\"20\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t\t<text class=\"btn-text\">{{ loading ? '登录中...' : '微信登录' }}</text>\r\n\t\t\t\t</button>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"agreement-area\">\r\n\t\t\t\t\t<view class=\"checkbox\" @tap=\"toggleAgreement\">\r\n\t\t\t\t\t\t<view :class=\"['checkbox-inner', { checked: isAgreed }]\">\r\n\t\t\t\t\t\t\t<view v-if=\"isAgreed\" class=\"check-icon\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"agreement-text\">\r\n\t\t\t\t\t\t<text>我已阅读并同意</text>\r\n\t\t\t\t\t\t<text class=\"link\" @tap.stop=\"goToAgreement('user')\">《用户协议》</text>\r\n\t\t\t\t\t\t<text>和</text>\r\n\t\t\t\t\t\t<text class=\"link\" @tap.stop=\"goToAgreement('privacy')\">《隐私政策》</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tname: 'LoginModal',\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tloading: false,\r\n\t\t\t\tisAgreed: true\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tvisible() {\r\n\t\t\t\treturn this.$store.getters['user/showLoginModal'];\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 处理登录\r\n\t\t\tasync handleLogin() {\r\n\t\t\t\tif (!this.isAgreed) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请先同意用户协议和隐私政策',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this.loading) return;\r\n\t\t\t\t\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait this.$store.dispatch('user/login');\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('登录失败:', error);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '登录失败，请重试',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 切换协议勾选状态\r\n\t\t\ttoggleAgreement() {\r\n\t\t\t\tthis.isAgreed = !this.isAgreed;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 跳转至协议页面\r\n\t\t\tgoToAgreement(type) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/agreement/index?type=${type}`\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 取消登录\r\n\t\t\tcancel() {\r\n\t\t\t\tthis.$store.dispatch('user/hideLoginModal');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.login-modal {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tz-index: 9999;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t\r\n\t.modal-mask {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.6);\r\n\t}\r\n\t\r\n\t.modal-content {\r\n\t\twidth: 80%;\r\n\t\tmax-width: 600rpx;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 12rpx;\r\n\t\toverflow: hidden;\r\n\t\tposition: relative;\r\n\t\tz-index: 1;\r\n\t\tbox-shadow: 0 10rpx 20rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.modal-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-bottom: 1rpx solid #EEEEEE;\r\n\t}\r\n\t\r\n\t.modal-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333333;\r\n\t}\r\n\t\r\n\t.close-btn {\r\n\t\tpadding: 10rpx;\r\n\t}\r\n\t\r\n\t.modal-body {\r\n\t\tpadding: 40rpx 30rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.login-icon {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.login-icon image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t\r\n\t.login-tips {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666666;\r\n\t\tmargin-bottom: 40rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\t\r\n\t.wx-login-btn {\r\n\t\twidth: 100%;\r\n\t\theight: 80rpx;\r\n\t\tbackground: linear-gradient(135deg, #12B70D 0%, #3A9838 100%);\r\n\t\tborder-radius: 40rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tborder: none;\r\n\t}\r\n\t\r\n\t.btn-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #FFFFFF;\r\n\t\tmargin-left: 10rpx;\r\n\t}\r\n\t\r\n\t.agreement-area {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\t\r\n\t.checkbox {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\t\r\n\t.checkbox-inner {\r\n\t\twidth: 32rpx;\r\n\t\theight: 32rpx;\r\n\t\tborder: 1rpx solid #DDDDDD;\r\n\t\tborder-radius: 6rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t\r\n\t.checkbox-inner.checked {\r\n\t\tbackground-color: #fa5e44;\r\n\t\tborder-color: #fa5e44;\r\n\t}\r\n\t\r\n\t.check-icon {\r\n\t\twidth: 20rpx;\r\n\t\theight: 12rpx;\r\n\t\tborder: 2rpx solid #FFFFFF;\r\n\t\tborder-top: none;\r\n\t\tborder-right: none;\r\n\t\ttransform: rotate(-45deg);\r\n\t}\r\n\t\r\n\t.agreement-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999999;\r\n\t\tline-height: 1.4;\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.link {\r\n\t\tcolor: #fa5e44;\r\n\t}\r\n</style> ","<script>\r\n\timport { checkAndAutoLogin } from './utils/auth.js';\r\n\timport navigationControl from './utils/navigation-control.js';\r\n\timport { initUniCompatibility } from './utils/uni-compatibility.js';\r\n\timport LoginModal from './components/login-modal/index.vue';\r\n\t\r\n\t// 添加初始化状态标志\r\n\tlet isInitialized = false;\r\n\t\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tLoginModal\r\n\t\t},\r\n\t\tonLaunch: function() {\r\n\t\t\t// 只在首次加载时执行初始化\r\n\t\t\tif (!isInitialized) {\r\n\t\t\t\t// 初始化 uni-app 兼容性适配\r\n\t\t\t\tinitUniCompatibility();\r\n\t\t\t\t\r\n\t\t\t\t// 初始化请求拦截器\r\n\t\t\t\tthis.initRequestInterceptor();\r\n\t\t\t\t\r\n\t\t\t\t// 初始化导航拦截器\r\n\t\t\t\tthis.initNavigationInterceptor();\r\n\t\t\t\t\r\n\t\t\t\t// 标记已初始化完成\r\n\t\t\t\tisInitialized = true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 设置延迟以确保Vuex初始化完成后再执行自动登录\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t// 添加超时处理，避免登录请求阻塞应用加载\r\n\t\t\t\tconst loginTimeout = setTimeout(() => {\r\n\t\t\t\t\tconsole.log('自动登录超时，继续应用初始化');\r\n\t\t\t\t}, 3000); // 设置3秒超时\r\n\t\t\t\t\r\n\t\t\t\tthis.autoLogin().finally(() => {\r\n\t\t\t\t\tclearTimeout(loginTimeout);\r\n\t\t\t\t});\r\n\t\t\t}, 100);\r\n\t\t\t\r\n\t\t\t// 禁用SharedArrayBuffer相关功能，避免安全警告\r\n\t\t\tthis.disableSharedArrayBuffer();\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\t// App Show时不重复执行自动登录，避免重复请求\r\n\t\t\t// 仅在onLaunch中执行自动登录即可\r\n\t\t\t\r\n\t\t\t// 添加区域列表的初始化，确保每次打开应用时都加载最新的区域列表\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t// 获取store实例\r\n\t\t\t\tconst store = this.$store;\r\n\t\t\t\tif (store && store.dispatch) {\r\n\t\t\t\t\t// 加载区域列表数据\r\n\t\t\t\t\tconsole.log('App显示时开始加载区域列表数据...');\r\n\t\t\t\t\tstore.dispatch('region/getRegionList')\r\n\t\t\t\t\t\t.then((regionList) => {\r\n\t\t\t\t\t\t\t// 区域列表加载成功后，检查并更新当前位置\r\n\t\t\t\t\t\t\tif (regionList && regionList.length > 0) {\r\n\t\t\t\t\t\t\t\t// 检查当前是否已设置位置\r\n\t\t\t\t\t\t\t\tconst currentLocationId = uni.getStorageSync('currentLocationId');\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// 如果没有设置位置ID，则使用第一个区域\r\n\t\t\t\t\t\t\t\tif (!currentLocationId) {\r\n\t\t\t\t\t\t\t\t\tconst firstRegion = regionList[0];\r\n\t\t\t\t\t\t\t\t\tuni.setStorageSync('currentLocationId', firstRegion.id);\r\n\t\t\t\t\t\t\t\t\tuni.setStorageSync('currentLocation', firstRegion.name);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tconsole.log('App显示时更新位置信息:', firstRegion.name, firstRegion.id);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// 通知所有监听此事件的组件位置已变更\r\n\t\t\t\t\t\t\t\t\tuni.$emit('locationChanged', { regionId: firstRegion.id });\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// 如果已有位置ID，也发送locationChanged事件以触发内容刷新\r\n\t\t\t\t\t\t\t\t\tconsole.log('App显示时发送位置更新事件，使用已有位置ID:', currentLocationId);\r\n\t\t\t\t\t\t\t\t\tuni.$emit('locationChanged', { regionId: currentLocationId });\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\t\tconsole.error('初始化区域列表失败:', err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, 200);\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\t// App隐藏时的处理\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 自动登录方法\r\n\t\t\tasync autoLogin() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 检查是否已登录\r\n\t\t\t\t\tconst hasToken = this.$store.getters['user/token'];\r\n\t\t\t\t\tif (!hasToken) {\r\n\t\t\t\t\t\tconst result = await checkAndAutoLogin();\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\t// 先设置token，确保登录状态\r\n\t\t\t\t\t\t\tif (result.token) {\r\n\t\t\t\t\t\t\t\tthis.$store.commit('user/SET_TOKEN', result.token);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 再设置用户信息\r\n\t\t\t\t\t\t\tthis.$store.commit('user/SET_USER_INFO', result.userInfo || result);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 有token但没有完整用户信息时，获取用户信息\r\n\t\t\t\t\t\tconst userInfo = this.$store.getters['user/userInfo'];\r\n\t\t\t\t\t\t// 检查是否有用户ID (clientId或id)和基本信息\r\n\t\t\t\t\t\tconst hasUserId = userInfo && (userInfo.clientId || userInfo.id);\r\n\t\t\t\t\t\tconst hasBasicInfo = userInfo && userInfo.realName;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (!hasUserId || !hasBasicInfo) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tawait this.$store.dispatch('user/getUserInfo');\r\n\t\t\t\t\t\t\t} catch (infoError) {\r\n\t\t\t\t\t\t\t\t// 尝试静默登录\r\n\t\t\t\t\t\t\t\tawait this.$store.dispatch('user/silentLogin');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\t// 登录失败时不做特殊处理，用户可以在页面上手动登录\r\n\t\t\t\t\tconsole.log('自动登录失败:', error);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve(); // 确保总是返回已解决的Promise\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 初始化请求拦截器\r\n\t\t\tinitRequestInterceptor() {\r\n\t\t\t\t// 添加请求拦截器\r\n\t\t\t\tuni.addInterceptor('request', {\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\treturn err;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 添加响应拦截器\r\n\t\t\t\tuni.addInterceptor('response', {\r\n\t\t\t\t\tresponse(res) {\r\n\t\t\t\t\t\t// 统一处理401认证失败\r\n\t\t\t\t\t\tif (res.statusCode === 401) {\r\n\t\t\t\t\t\t\t// 提示用户重新登录\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '登录已过期，请重新登录',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 清除登录状态\r\n\t\t\t\t\t\t\tconst store = getApp().$vm.$store;\r\n\t\t\t\t\t\t\tif (store) {\r\n\t\t\t\t\t\t\t\tstore.dispatch('user/logout');\r\n\t\t\t\t\t\t\t\t// 显示登录弹窗\r\n\t\t\t\t\t\t\t\tstore.dispatch('user/showLoginModal');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn res;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 初始化导航拦截器\r\n\t\t\tinitNavigationInterceptor() {\r\n\t\t\t\t// 初始化基本的导航拦截\r\n\t\t\t\tnavigationControl.initNavigationInterceptors();\r\n\t\t\t\t\r\n\t\t\t\t// 处理页面返回的特殊情况\r\n\t\t\t\tuni.addInterceptor('navigateBack', {\r\n\t\t\t\t\tinvoke(args) {\r\n\t\t\t\t\t\t// 获取当前页面栈\r\n\t\t\t\t\t\tconst pages = getCurrentPages();\r\n\t\t\t\t\t\tif (pages.length < 2) return args;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 当前页面和目标页面\r\n\t\t\t\t\t\tconst currentPage = pages[pages.length - 1];\r\n\t\t\t\t\t\tconst targetPage = pages[pages.length - 2];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 获取页面路径\r\n\t\t\t\t\t\tconst currentPath = `/${currentPage.route}`;\r\n\t\t\t\t\t\tconst targetPath = `/${targetPage.route}`;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 处理页面返回的轮询控制\r\n\t\t\t\t\t\tnavigationControl.beforeNavigateBack(currentPath, targetPath);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn args;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 禁用SharedArrayBuffer相关功能\r\n\t\t\tdisableSharedArrayBuffer() {\r\n\t\t\t\t// 在小程序环境中，通过设置自定义拦截器来处理网络请求头\r\n\t\t\t\tuni.addInterceptor('request', {\r\n\t\t\t\t\tinvoke(args) {\r\n\t\t\t\t\t\t// 添加安全相关的请求头\r\n\t\t\t\t\t\tif (!args.header) {\r\n\t\t\t\t\t\t\targs.header = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 防止使用SharedArrayBuffer\r\n\t\t\t\t\t\targs.header['Cross-Origin-Opener-Policy'] = 'same-origin';\r\n\t\t\t\t\t\targs.header['Cross-Origin-Embedder-Policy'] = 'require-corp';\r\n\t\t\t\t\t\treturn args;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 拦截WebView组件的加载\r\n\t\t\t\tif (typeof wx !== 'undefined' && wx.onWebViewLoad) {\r\n\t\t\t\t\twx.onWebViewLoad(function() {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t// 禁用SharedArrayBuffer\r\n\t\t\t\t\t\t\tif (typeof SharedArrayBuffer !== 'undefined') {\r\n\t\t\t\t\t\t\t\t// 在开发环境输出日志，不影响功能\r\n\t\t\t\t\t\t\t\tconsole.warn('已禁用SharedArrayBuffer以提高安全性');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t// 忽略错误\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t/*每个页面公共css */\r\n\t/* 隐藏所有滚动条 */\r\n\t::-webkit-scrollbar {\r\n\t\tdisplay: none;\r\n\t\twidth: 0 !important;\r\n\t\theight: 0 !important;\r\n\t}\r\n\t\r\n\t/* 隐藏scroll-view的滚动条 - 修改为更符合微信小程序规范的写法 */\r\n\t.scroll-view-container ::-webkit-scrollbar {\r\n\t\tdisplay: none;\r\n\t}\r\n\t\r\n\t/* 添加全局滚动条隐藏 */\r\n\t::-webkit-scrollbar {\r\n\t\twidth: 0;\r\n\t\theight: 0;\r\n\t\tcolor: transparent;\r\n\t\tdisplay: none;\r\n\t}\r\n\t\r\n\tpage {\r\n\t\theight: 100%;\r\n\t\toverflow: hidden;\r\n\t}\r\n</style>\r\n\r\n<!-- 添加登录弹窗组件 -->\r\n<template>\r\n\t<login-modal></login-modal>\r\n</template>\r\n","import App from './App'\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\n\n// 添加全局错误处理\nVue.config.errorHandler = function(err, vm, info) {\n  console.error('Vue错误:', err);\n  console.error('错误信息:', info);\n};\n\n// 添加Promise未捕获异常处理\nuni.addInterceptor({\n  returnValue(res) {\n    if (!(res instanceof Promise)) {\n      return res;\n    }\n    return new Promise((resolve, reject) => {\n      res.then(res => {\n        resolve(res);\n      }).catch(error => {\n        console.error('Promise未捕获异常:', error);\n        reject(error);\n      });\n    });\n  }\n});\n\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\nimport store from './store'\n\nexport function createApp() {\n  const app = createSSRApp(App)\n  \n  // 挂载Vuex\n  app.use(store)\n  \n  // 添加全局错误处理\n  app.config.errorHandler = function(err, instance, info) {\n    console.error('Vue错误:', err);\n    console.error('错误信息:', info);\n  };\n  \n  return {\n    app\n  }\n}\n// #endif"],"names":["_sfc_main","uni","initUniCompatibility","checkAndAutoLogin","navigationControl","wx","createSSRApp","store"],"mappings":"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"}