{"version":3,"file":"device-unified.js","sources":["mixins/device-unified.js"],"sourcesContent":["/**\r\n * 设备信息与适配统一混入\r\n * 合并了device.js和device-adapter.js的功能\r\n */\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 设备相关\r\n      isIOS: false,\r\n      isAndroid: false,\r\n      statusBarHeight: 20,\r\n      navBarHeight: 44,\r\n      // 屏幕信息\r\n      screenWidth: 375,\r\n      screenHeight: 667,\r\n      // 安全区域\r\n      safeAreaInsets: {\r\n        top: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        left: 0\r\n      }\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.initDeviceInfo()\r\n  },\r\n\r\n  computed: {\r\n    // 导航栏总高度（状态栏+导航栏）\r\n    navigationBarHeight() {\r\n      return this.statusBarHeight + this.navBarHeight\r\n    },\r\n\r\n    // 获取安全区域高度\r\n    safeAreaHeight() {\r\n      return this.screenHeight - this.safeAreaInsets.top - this.safeAreaInsets.bottom\r\n    },\r\n\r\n    // 获取内容区域高度(去除导航栏和安全区域)\r\n    contentHeight() {\r\n      return this.safeAreaHeight - this.navigationBarHeight\r\n    },\r\n\r\n    // 是否是小屏幕设备\r\n    isSmallScreen() {\r\n      return this.screenWidth <= 320\r\n    },\r\n\r\n    // 是否是大屏幕设备\r\n    isLargeScreen() {\r\n      return this.screenWidth >= 768\r\n    },\r\n\r\n    // 统一布局尺寸\r\n    layoutSize() {\r\n      return {\r\n        // 底部结算栏高度(不含安全区域)\r\n        settlementHeight: 120,  // 固定120rpx\r\n        // 内容区域底部间距\r\n        contentBottom: 160,     // 固定160rpx\r\n        // 导航栏高度\r\n        navHeight: this.navBarHeight,\r\n        // 卡片间距\r\n        cardGap: 20,           // 固定20rpx\r\n        // 内容区域水平内边距\r\n        contentPadding: 20     // 固定20rpx\r\n      }\r\n    },\r\n\r\n    // 屏幕尺寸\r\n    screenSize() {\r\n      return {\r\n        width: this.screenWidth,\r\n        height: this.screenHeight\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 初始化设备信息\r\n    initDeviceInfo() {\r\n      try {\r\n        // 使用新的API获取系统信息\r\n        const systemInfo = uni.getWindowInfo ? uni.getWindowInfo() : uni.getSystemInfoSync();\r\n        const deviceInfo = uni.getDeviceInfo ? uni.getDeviceInfo() : {};\r\n        const appBaseInfo = uni.getAppBaseInfo ? uni.getAppBaseInfo() : {};\r\n        \r\n        // 判断系统类型\r\n        this.isIOS = (appBaseInfo.platform === 'ios') || \r\n          (systemInfo.platform === 'ios') || \r\n          (/ios/i.test(systemInfo.system));\r\n        \r\n        this.isAndroid = (appBaseInfo.platform === 'android') || \r\n          (systemInfo.platform === 'android') || \r\n          (/android/i.test(systemInfo.system));\r\n        \r\n        // 获取状态栏高度\r\n        this.statusBarHeight = systemInfo.statusBarHeight || 20;\r\n        \r\n        // 设置导航栏高度\r\n        this.navBarHeight = this.isIOS ? 44 : 48;\r\n        \r\n        // 获取屏幕信息\r\n        this.screenWidth = systemInfo.screenWidth || 375;\r\n        this.screenHeight = systemInfo.screenHeight || 667;\r\n        \r\n        // 获取安全区域\r\n        const safeArea = systemInfo.safeArea;\r\n        if (safeArea) {\r\n          this.safeAreaInsets = {\r\n            top: safeArea.top,\r\n            right: this.screenWidth - safeArea.right,\r\n            bottom: this.screenHeight - safeArea.bottom,\r\n            left: safeArea.left\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('获取设备信息失败:', error);\r\n        // 使用默认值继续\r\n      }\r\n    },\r\n\r\n    // 刷新设备信息（窗口大小变化时调用）\r\n    refreshDeviceInfo() {\r\n      this.initDeviceInfo();\r\n    },\r\n\r\n    // rpx 转 px\r\n    rpxToPx(rpx) {\r\n      return rpx / 750 * this.screenWidth\r\n    },\r\n\r\n    // px 转 rpx\r\n    pxToRpx(px) {\r\n      return px * 750 / this.screenWidth\r\n    },\r\n\r\n    // 判断是否为 iPhone X 系列\r\n    isIphoneX() {\r\n      return this.isIOS && this.safeAreaInsets.bottom > 0\r\n    },\r\n\r\n    // 获取底部安全距离\r\n    getBottomSafeDistance() {\r\n      return this.isIphoneX() ? this.safeAreaInsets.bottom : 0\r\n    },\r\n\r\n    // 获取元素布局信息\r\n    async getElementRect(selector) {\r\n      return new Promise((resolve) => {\r\n        uni.createSelectorQuery()\r\n          .select(selector)\r\n          .boundingClientRect(data => {\r\n            resolve(data)\r\n          })\r\n          .exec()\r\n      })\r\n    }\r\n  }\r\n} "],"names":["uni"],"mappings":";;AAKA,MAAe,cAAA;AAAA,EACb,OAAO;AACL,WAAO;AAAA;AAAA,MAEL,OAAO;AAAA,MACP,WAAW;AAAA,MACX,iBAAiB;AAAA,MACjB,cAAc;AAAA;AAAA,MAEd,aAAa;AAAA,MACb,cAAc;AAAA;AAAA,MAEd,gBAAgB;AAAA,QACd,KAAK;AAAA,QACL,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,MAAM;AAAA,MACP;AAAA,IACF;AAAA,EACF;AAAA,EAED,UAAU;AACR,SAAK,eAAgB;AAAA,EACtB;AAAA,EAED,UAAU;AAAA;AAAA,IAER,sBAAsB;AACpB,aAAO,KAAK,kBAAkB,KAAK;AAAA,IACpC;AAAA;AAAA,IAGD,iBAAiB;AACf,aAAO,KAAK,eAAe,KAAK,eAAe,MAAM,KAAK,eAAe;AAAA,IAC1E;AAAA;AAAA,IAGD,gBAAgB;AACd,aAAO,KAAK,iBAAiB,KAAK;AAAA,IACnC;AAAA;AAAA,IAGD,gBAAgB;AACd,aAAO,KAAK,eAAe;AAAA,IAC5B;AAAA;AAAA,IAGD,gBAAgB;AACd,aAAO,KAAK,eAAe;AAAA,IAC5B;AAAA;AAAA,IAGD,aAAa;AACX,aAAO;AAAA;AAAA,QAEL,kBAAkB;AAAA;AAAA;AAAA,QAElB,eAAe;AAAA;AAAA;AAAA,QAEf,WAAW,KAAK;AAAA;AAAA,QAEhB,SAAS;AAAA;AAAA;AAAA,QAET,gBAAgB;AAAA;AAAA,MACjB;AAAA,IACF;AAAA;AAAA,IAGD,aAAa;AACX,aAAO;AAAA,QACL,OAAO,KAAK;AAAA,QACZ,QAAQ,KAAK;AAAA,MACd;AAAA,IACF;AAAA,EACF;AAAA,EAED,SAAS;AAAA;AAAA,IAEP,iBAAiB;AACf,UAAI;AAEF,cAAM,aAAaA,cAAG,MAAC,gBAAgBA,cAAAA,MAAI,kBAAkBA,cAAAA,MAAI;AACjE,cAAM,aAAaA,cAAAA,MAAI,gBAAgBA,cAAAA,MAAI,cAAe,IAAG;AAC7D,cAAM,cAAcA,cAAAA,MAAI,iBAAiBA,cAAAA,MAAI,eAAgB,IAAG;AAGhE,aAAK,QAAS,YAAY,aAAa,SACpC,WAAW,aAAa,SACxB,OAAO,KAAK,WAAW,MAAM;AAEhC,aAAK,YAAa,YAAY,aAAa,aACxC,WAAW,aAAa,aACxB,WAAW,KAAK,WAAW,MAAM;AAGpC,aAAK,kBAAkB,WAAW,mBAAmB;AAGrD,aAAK,eAAe,KAAK,QAAQ,KAAK;AAGtC,aAAK,cAAc,WAAW,eAAe;AAC7C,aAAK,eAAe,WAAW,gBAAgB;AAG/C,cAAM,WAAW,WAAW;AAC5B,YAAI,UAAU;AACZ,eAAK,iBAAiB;AAAA,YACpB,KAAK,SAAS;AAAA,YACd,OAAO,KAAK,cAAc,SAAS;AAAA,YACnC,QAAQ,KAAK,eAAe,SAAS;AAAA,YACrC,MAAM,SAAS;AAAA,UAChB;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAA,MAAA,MAAA,SAAA,mCAAc,aAAa,KAAK;AAAA,MAEjC;AAAA,IACF;AAAA;AAAA,IAGD,oBAAoB;AAClB,WAAK,eAAc;AAAA,IACpB;AAAA;AAAA,IAGD,QAAQ,KAAK;AACX,aAAO,MAAM,MAAM,KAAK;AAAA,IACzB;AAAA;AAAA,IAGD,QAAQ,IAAI;AACV,aAAO,KAAK,MAAM,KAAK;AAAA,IACxB;AAAA;AAAA,IAGD,YAAY;AACV,aAAO,KAAK,SAAS,KAAK,eAAe,SAAS;AAAA,IACnD;AAAA;AAAA,IAGD,wBAAwB;AACtB,aAAO,KAAK,UAAW,IAAG,KAAK,eAAe,SAAS;AAAA,IACxD;AAAA;AAAA,IAGD,MAAM,eAAe,UAAU;AAC7B,aAAO,IAAI,QAAQ,CAAC,YAAY;AAC9BA,sBAAAA,MAAI,oBAAqB,EACtB,OAAO,QAAQ,EACf,mBAAmB,UAAQ;AAC1B,kBAAQ,IAAI;AAAA,QACxB,CAAW,EACA,KAAM;AAAA,MACjB,CAAO;AAAA,IACF;AAAA,EACF;AACH;;"}